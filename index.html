<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
  const urlParams = new URLSearchParams(window.location.search);
  const id = urlParams.get('id');
  const output = document.getElementById('output');

  if (!id) {
    output.innerHTML = '<p class="no-data">Не указан ID. Обратитесь к координатору.</p>';
  } else {
    Papa.parse("https://corsproxy.io/?https://cloud.vrnds.ru/s/zw7yTzDBqLWYiF4/download?download=1", {
      download: true,
      header: true,
      complete: function(results) {
        const data = results.data;
        const person = data.find(row => row.id === id);

        if (!person) {
          output.innerHTML = '<p class="no-data">Данные не найдены.</p>';
          return;
        }

        output.innerHTML = `
          <h2>${person['ФИО']}</h2>
          <table>
            <tr><th>Дата</th><td>${person['Дата']}</td></tr>
            <tr><th>Мероприятие</th><td>${person['Мероприятие']}</td></tr>
            <tr><th>Комментарий</th><td>${person['Комментарий']}</td></tr>
          </table>
        `;
      },
      error: function(err, file, inputElem, reason) {
        output.innerHTML = `<p class="no-data">Ошибка загрузки CSV: ${reason || err}</p>`;
        console.error("Ошибка:", err || reason);
      }
    });
  }
</script>
